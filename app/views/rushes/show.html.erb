<section class='rush'>
    <h1><%= @rush.name %></h1>
    <h1 class='rank'>Rank #4</h1>
    <article class='photo_container'>
        <div class='background'></div>
        <div class='photo' style='background-image: url(https://sphotos-a.xx.fbcdn.net/hphotos-ash4/374956_10151016320080437_1318987276_n.jpg) '></div>
    </article>
    <article class='info'>
        <dl class="dl-horizontal">
            <%= form_for( @rush, :namespace => 'edit_info', :url => edit_rush_path( @rush ), :html => { :method => :post, :class => "edit_rush_info" } ) do |f| %>
            <dt><h3>Phone<h3></dt>
            <dd>
                <article class='show'>
                    <% if @rush.phone.length == 10 %>
                        (<%= @rush.phone[0..2] %>)<%= @rush.phone[3..5] %>-<%= @rush.phone[6..9] %>
                    <% else %>
                        <%= @rush.phone %>
                    <% end %>
                </article>
                <article class='hide'>
                    <input id="edit_rush_phone_field" name="rush[phone]" value="<%= @rush.phone %>" />
                </article>
            </dd>
            <dt><h3>Email<h3></dt>
            <dd>
                <article class='show'>
                    <%= @rush.email %>
                </article>
                <article class='hide'>
                    <input id="edit_rush_email_field" name="rush[email]" value="<%= @rush.email %>" />
                </article>
            </dd>
            <dt><h3>Residence<h3></dt>
            <dd>
                <article class='show'>
                    <%= @rush.residence %>
                </article>
                <article class='hide'>
                    <input id="edit_rush_residence_field" name="rush[residence]" value="<%= @rush.residence %>" />
                </article>
            </dd>
            <dt><h3>From<h3></dt>
            <dd>
                <article class='show'>
                    <%= @rush.origin %>
                </article>
                <article class='hide'>
                    <input id="edit_rush_origin_field" name="rush[origin]" value="<%= @rush.origin %>" />
                </article>
            </dd>

            <article class='hide'>
                <input type='button' value='cancel' id='edit_info_button_cancel' class='btn'/>
                <%= f.submit "submit", :class => 'btn', :id => 'edit_info_button_submit' %>
            </article>
            <% end %>
            <article class='show'>
                <button id="edit_info_button" class="btn">edit</button>
            </article>
        </dl>
        <div class='chilltopull'>
            <span class='chill'>Chill</span>
            <span class='pull'>Pull</span>
        </div>
        <div class="progress">
            <div class="bar bar-info" style="width: <%=@average_chill*10%>%;"><p><%= @average_chill%></p></div>
            <div class="bar bar-success" style="width: <%=@average_pull*10%>%;"><p><%= @average_pull%></p></div>
        </div>
        <div class='friendswith'>
            <h3>Friends with</h3>
            <ul>
                <li><a>Joe</a></li>
                <li><a>Jake</a></li>
            </ul>
        </div>
        <div class='attended'>
            <h3>Attended</h3>
            <ul>
                <li><a>Civy (10/03)</a></li>
                <li><a>Animal Party</a></li>
            </ul>
        </div>
    </article>
    <article class='comments'>
        <%= form_for @rush_comment do |f| %>
            <%= f.text_area :text, :placeholder => "Say something about " + @rush.name.split[0] %>

            <input id="new_rush_comment_rush_id" name="rush_comment[rush_id]" type="hidden" value= <%= @rush.id %> >
            <input id="new_rush_comment_user_id" name="rush_comment[user_id]" type="hidden" value= <%= current_user.id %> >

            
            <%= f.submit 'Submit', :class => 'new_comment btn-large btn btn-success' %>
        <% end %>

        <article class='slider_container'>
            <!-- If not yet already voted -->
            <% if @current_rating.blank? %>
                <b>How is <%= @rush.name.split[0] %>'s chill and pull?</b><br/>
                <p>Chill</p>
                <div class='slider slider_chill'></div>
                <p class='results slider_chill_results'>5</p>
                <p>Pull</p>
                <div class='slider slider_pull'></div>
                <p class='results slider_pull_results'>5</p>
                <%= form_for @cprating do |f| %>
                    <input id="new_cprating_pull" name="cprating[pull]" type="hidden" class="slider_pull_form" value='5'/>
                    <input id="new_cprating_chill" name="cprating[chill]" type="hidden" class="slider_chill_form" value='5'/>
                    <input id="new_cprating_rush_id" name="cprating[rush_id]" type="hidden" value= <%= @rush.id %> >
                    <input id="new_cprating_user_id" name="cprating[user_id]" type="hidden" value= <%= current_user.id %> >
                    <%= f.submit 'vote', :class => 'btn' %>
                <% end %>
            <% else %>
                <!-- Already voted -->
                <b>You have already voted for <%= @rush.name.split[0] %></b><br/>
                <p>Chill</p>
                <div class='slider slider_chill'></div>
                <p class='results slider_chill_results'><%= @current_rating.chill %></p>
                <p>Pull</p>
                <div class='slider slider_pull'></div>
                <p class='results slider_pull_results'><%= @current_rating.pull %></p>
                <%= form_for @cprating, :url => edit_cprating_path(@current_rating), :html => { :method => :post} do |f| %>
                    <input id="new_cprating_pull" name="cprating[pull]" type="hidden" class="slider_pull_form" value='<%= @current_rating.pull %>'/>
                    <input id="new_cprating_chill" name="cprating[chill]" type="hidden" class="slider_chill_form" value='<%= @current_rating.chill %>'/>
                    <input id="new_cprating_rush_id" name="cprating[rush_id]" type="hidden" value= <%= @rush.id %> >
                    <input id="new_cprating_user_id" name="cprating[user_id]" type="hidden" value= <%= current_user.id %> >
                    <%= f.submit 'change', :class => 'btn' %>
                <% end %>
            <% end %>
        </article>

        <% if !@rush_comments.blank? %>
            <% for item in @rush_comments %>
                <blockquote>
                    <article class='show'>
                        <p>
                            <% if User.find_by_id(item.user_id) %>
                                <a href='/users/<%= item.user_id%>'>
                                    <%=User.find_by_id(item.user_id).name%>
                                </a>
                            <% end %>
                            <%= item.text %>
                        </p>
                        <small>updated at: <cite title="Source Title"><%= item.updated_at.localtime.strftime("%I:%M%p %m/%d/%Y")%></cite></small>
                    </article>
                    <% if item.user_id == current_user.id %>
                        <%= form_for( @rush_comment, :namespace => 'edit', :url => edit_rush_comment_path( item ), :html => { :method => :post, :class => "edit_new_rush_comment" } ) do |f| %>
                            <textarea id="edit_rush_comment_text" name="rush_comment[text]"><%= item.text %></textarea>
                            <%= f.submit "Submit", :class => 'btn' %>
                            <input type='button' value='cancel' class='btn edit_button_cancel'/>
                        <% end %>
                        <article class='buttons'>
                            <button class="edit_button btn-small btn">edit</button>
                            <%= link_to 'delete', item, :confirm => 'Are you sure you want to delete this comment?', :method => :delete, :class => 'btn-small btn' %>
                        </article>
                    <% end %>
                </blockquote>
          <% end %>
        <% else %>

        <% end %>
    </article>
</section>